{# TODO: this is tied to the app, solve this dirty dependency #}
{% block _app_collect_data_carrierDetails_map_widget %}
    {% spaceless %}
        {% if form.parent.children.address.vars.data is not empty %}
            {% set styleStr = '' %}
            {% set infoStr = form.parent.children.address.vars.data %}
        {% else %}
            {% set styleStr = 'display: none' %}
            {% set infoStr = '' %}
        {% endif %}

        <div id="selected_shop_info_wrapper" style="{{ styleStr }}">
            Kiv√°lasztott Pick Pack Pont: <span id="selected_shop_info">{{ infoStr }}</span>
            <br/><br/>
        </div>
        <iframe width="100%" height="505px" src="https://online.sprinter.hu/terkep/#/" id="tesztelek"></iframe>

        <script>
            $(document).ready(function () {
                function receiveMessage(event) {
                    data = JSON.parse(event.data);
                    $('#app_collect_data_carrierDetails_code').val(data.shopCode);
                    var details = data.shopName + ', ' + data.address;
                    $('#app_collect_data_carrierDetails_address').val(details);
                    $('#selected_shop_info').html(details);
                    $('#selected_shop_info_wrapper').show();
                };

                window.addEventListener("message", receiveMessage, false);
            });
        </script>

    {% endspaceless %}
{% endblock %}